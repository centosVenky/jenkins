def mvn_version = 'Maven 3.5.2'
def java_home = 'JDK 8u151'

stage('welcome to jenkins'){
node{
echo 'This stage of pipeline is for entering credentials of nexus 3'
input message: 'Enter Nexus username and password', parameters: [password(defaultValue: 'pass@123', description: '', name: 'admin')]
}

}

stage('nexus GAV parameters phase'){
node{
input message: 'Enter GAV Parameters', parameters: [string(defaultValue: 'com.zycus', description: '', name: 'Group', trim: false), string(defaultValue: '', description: '', name: 'Artifact', trim: false), string(defaultValue: '', description: '', name: 'Version', trim: false)]

  }

}
stage('upload the build'){
node{
input message: 'Upload the build ', parameters: [file(description: 'please upload the build file as zip and naming convention of the file should be builds.zip', name: 'builds.zip')]
echo 'Build sucessfully uploaded'
}
}
stage ('install maven'){
        withEnv( ["JAVA_HOME=${ tool java_home }", "PATH+MAVEN=${tool mvn_version}/bin"] ) {
        sh "mvn clean package"
        }
} 
stage('Upload Artifact to Release Repo(maven.releases)') {
        
            withEnv( ["JAVA_HOME=${ tool java_home }", "PATH+MAVEN=${tool mvn_version}/bin"] ) {
            sh '''mvn deploy:deploy-file -Dfile=builds.zip
    -DrepositoryId=maven-releases
    -Durl=http://192.168.6.235:5656/repository/maven-releases/'''

            echo "artifact uploaded"
            }
            
            
        }



